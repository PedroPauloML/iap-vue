<template>
  <div id="header">
    <v-app-bar color="white" app hide-on-scroll>
      <v-app-bar-nav-icon
        v-if="$vuetify.breakpoint.width < $vuetify.breakpoint.thresholds.sm"
        @click.stop="drawer = !drawer"
      ></v-app-bar-nav-icon>

      <v-toolbar-title class="d-flex">
        <svg
          v-if="$vuetify.breakpoint.width > $vuetify.breakpoint.thresholds.xs"
          width="45"
          viewBox="0 0 60 61"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
          class="mr-3"
        >
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M23.937 11.3186L23.4605 12.2983C22.628 14.0101 23.1663 15.2422 23.6867 16.4336L23.6872 16.4346L23.6876 16.4356C24.2361 17.6914 24.8029 18.9892 23.3415 20.4639L23.3261 20.4779C22.9818 20.7872 22.6592 20.8718 22.4094 20.8718C22.3415 20.8718 22.2793 20.8655 22.224 20.8557C21.7243 20.7704 21.2709 20.3589 20.8748 19.6332C20.2052 18.3562 19.9945 17.0406 20.229 15.6075C20.3878 13.9658 21.3108 12.6839 22.9699 11.8211L23.937 11.3186ZM22.345 20.1455C22.4017 20.156 22.5718 20.184 22.837 19.9488C23.945 18.8254 23.5601 17.944 23.0279 16.725L23.0273 16.7236C22.59 15.7237 22.0651 14.5229 22.4367 13.0093C21.5417 13.7027 21.0512 14.5907 20.9434 15.7006C20.7321 16.9972 20.9182 18.1651 21.5102 19.2939C21.7803 19.7886 22.0854 20.1014 22.345 20.1455Z"
            fill="#004B83"
          />
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M0 30.0297C0 13.4712 13.4579 0 29.9997 0C46.5421 0 60 13.4712 60 30.0297C60 46.5883 46.5421 60.0602 29.9997 60.0602C29.0998 60.0602 28.1537 60.014 27.188 59.9244L26.5603 59.8656L26.9291 59.3548C27.1026 59.1113 29.0186 55.6181 29.1298 52.903C29.3454 50.092 29.0473 47.6596 28.2187 45.454C27.3012 43.0132 25.872 40.7451 23.5058 36.9899L22.8627 35.9687C22.1847 34.8903 21.5087 33.8281 20.8642 32.8162L20.8532 32.7988C18.9272 29.7713 17.2649 27.1582 16.6642 25.8689C16.1891 24.8494 15.0743 22.2931 14.9799 20.571C14.9526 20.0707 14.9533 19.5892 14.9659 19.1757C13.9631 20.8019 12.3236 24.3784 12.9995 29.6386C13.4999 33.5062 14.3998 38.0372 14.6573 39.1064C14.8574 39.9372 15.0232 40.67 15.19 41.4072L15.3424 42.079C15.553 43.0076 15.8658 45.4708 15.905 45.7829C15.9069 45.7953 15.9078 45.8045 15.9084 45.8106C15.9087 45.8134 15.9092 45.8172 15.9092 45.8172L15.194 45.9011C15.194 45.9011 15.1926 45.8948 15.1919 45.885C15.1702 45.7297 14.8903 43.9166 13.2704 42.3687C12.1976 41.3428 11.7603 40.93 11.5832 40.7634L11.5797 40.7641L11.4489 40.6403L11.4468 40.6383C11.3388 40.535 9.42088 38.7 8.93531 37.4773L8.80935 37.1618L8.80106 37.1409C8.44396 36.2427 8.34609 35.9965 8.25303 35.5215C8.25112 35.5106 8.24905 35.4998 8.24697 35.4888C8.24451 35.4758 8.24202 35.4627 8.23974 35.4494C7.85697 36.3864 7.39232 38.0001 7.4623 40.2099C7.58686 44.1818 8.97519 47.456 9.03467 47.5932C9.08996 47.7226 9.2488 48.1236 9.45523 48.6463L9.46837 48.6795C9.954 49.9062 10.6769 51.7321 10.9688 52.332L11.7358 53.9085L10.409 52.7623C3.79413 47.0445 0 38.7593 0 30.0297ZM27.8157 59.2541C28.5644 59.3107 29.2971 59.3387 29.9997 59.3387C46.1446 59.3387 59.2799 46.1908 59.2799 30.0297C59.2799 13.8687 46.1446 0.720058 29.9997 0.720058C13.8554 0.720058 0.720058 13.8687 0.720058 30.0297C0.720058 37.9973 3.95927 45.5862 9.65956 51.1011C9.36496 50.3761 9.04097 49.5574 8.78556 48.9115C8.58262 48.3986 8.42658 48.0046 8.37199 47.8773C8.21875 47.5204 6.8689 44.27 6.74154 40.2323C6.61838 36.3171 8.0564 34.1842 8.11798 34.0954L8.63861 33.3396L8.77086 34.2479C8.77156 34.2549 8.86673 34.9036 8.9605 35.3829C9.04167 35.7958 9.12564 36.0071 9.47902 36.8951L9.60498 37.2114C10.0353 38.2961 11.9261 40.0994 11.9457 40.1176L11.931 40.133C12.1651 40.3154 12.6366 40.7658 13.7642 41.8432L13.7686 41.8474C14.1842 42.2449 14.5201 42.6563 14.7916 43.0566C14.7378 42.7305 14.686 42.4429 14.6398 42.2385L14.4814 41.5391C14.3173 40.8145 14.1538 40.0922 13.9568 39.275C13.6965 38.1953 12.7882 33.6251 12.2844 29.7302C11.2942 22.0258 14.9834 17.8664 15.1408 17.6929L15.8924 16.8664L15.7657 17.9763C15.7643 17.9882 15.6272 19.21 15.6999 20.5318C15.7601 21.6395 16.3647 23.5212 17.3171 25.5645C17.8993 26.8136 19.5549 29.416 21.4723 32.4292C22.1175 33.4425 22.7935 34.5054 23.4729 35.5852L24.1118 36.5998C26.4225 40.2666 27.9493 42.6899 28.8933 45.2007C29.7596 47.5071 30.0724 50.0402 29.8492 52.9457C29.7533 55.3011 28.4371 58.098 27.8157 59.2541Z"
            fill="#004B83"
          />
        </svg>
        <div>
          <p class="primary--text font-weight-bold mb-0">
            IAP
          </p>
          <p class="primary--text body-2 mb-0 mt-n2">
            Paulo Afonso
          </p>
        </div>
      </v-toolbar-title>

      <v-spacer />

      <div
        v-if="$vuetify.breakpoint.width > $vuetify.breakpoint.thresholds.sm"
        class="d-flex fill-height align-center"
      >
        <router-link
          v-for="(route, index) in routes"
          :key="index"
          :to="{ name: route.path_name }"
          v-slot="{ href, isActive }"
        >
          <v-btn
            :to="href"
            :class="{ 'primary--text': isActive }"
            height="100%"
            text
            link
          >
            {{ route.title }}
          </v-btn>
        </router-link>
      </div>

      <v-spacer />

      <div v-if="userSigned">
        <v-btn icon>
          <v-icon>mdi-bell-outline</v-icon>
        </v-btn>

        <v-btn icon>
          <v-icon>mdi-cog-outline</v-icon>
        </v-btn>

        <v-menu v-model="profileMenu" offset-y min-width="200" max-width="300">
          <template v-slot:activator="{ on, attrs }">
            <v-btn icon v-bind="attrs" v-on="on">
              <v-icon>mdi-account-circle-outline</v-icon>
            </v-btn>
          </template>

          <v-list dense>
            <v-list-item>
              <v-list-item-avatar>
                <v-img src="https://picsum.photos/id/1012/100/100"></v-img>
              </v-list-item-avatar>
              <v-list-item-content>
                <v-list-item-title class="title">
                  {{ $store.state.user.user.profile.name }}
                </v-list-item-title>
                <v-list-item-subtitle>
                  {{ $store.state.user.user.email }}
                </v-list-item-subtitle>
              </v-list-item-content>
            </v-list-item>

            <v-divider></v-divider>

            <v-list-item-group color="primary">
              <v-list-item @click="signOut">
                <v-list-item-icon>
                  <v-icon>mdi-logout</v-icon>
                </v-list-item-icon>
                <v-list-item-content>
                  Sair
                </v-list-item-content>
              </v-list-item>
            </v-list-item-group>
          </v-list>
        </v-menu>
      </div>
      <Authentication v-else />
    </v-app-bar>

    <v-navigation-drawer v-model="drawer" fixed left temporary>
      <v-list nav dense>
        <v-list-item>
          <v-list-item-avatar>
            <svg
              width="60"
              viewBox="0 0 60 61"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M23.937 11.3186L23.4605 12.2983C22.628 14.0101 23.1663 15.2422 23.6867 16.4336L23.6872 16.4346L23.6876 16.4356C24.2361 17.6914 24.8029 18.9892 23.3415 20.4639L23.3261 20.4779C22.9818 20.7872 22.6592 20.8718 22.4094 20.8718C22.3415 20.8718 22.2793 20.8655 22.224 20.8557C21.7243 20.7704 21.2709 20.3589 20.8748 19.6332C20.2052 18.3562 19.9945 17.0406 20.229 15.6075C20.3878 13.9658 21.3108 12.6839 22.9699 11.8211L23.937 11.3186ZM22.345 20.1455C22.4017 20.156 22.5718 20.184 22.837 19.9488C23.945 18.8254 23.5601 17.944 23.0279 16.725L23.0273 16.7236C22.59 15.7237 22.0651 14.5229 22.4367 13.0093C21.5417 13.7027 21.0512 14.5907 20.9434 15.7006C20.7321 16.9972 20.9182 18.1651 21.5102 19.2939C21.7803 19.7886 22.0854 20.1014 22.345 20.1455Z"
                fill="#004B83"
              />
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M0 30.0297C0 13.4712 13.4579 0 29.9997 0C46.5421 0 60 13.4712 60 30.0297C60 46.5883 46.5421 60.0602 29.9997 60.0602C29.0998 60.0602 28.1537 60.014 27.188 59.9244L26.5603 59.8656L26.9291 59.3548C27.1026 59.1113 29.0186 55.6181 29.1298 52.903C29.3454 50.092 29.0473 47.6596 28.2187 45.454C27.3012 43.0132 25.872 40.7451 23.5058 36.9899L22.8627 35.9687C22.1847 34.8903 21.5087 33.8281 20.8642 32.8162L20.8532 32.7988C18.9272 29.7713 17.2649 27.1582 16.6642 25.8689C16.1891 24.8494 15.0743 22.2931 14.9799 20.571C14.9526 20.0707 14.9533 19.5892 14.9659 19.1757C13.9631 20.8019 12.3236 24.3784 12.9995 29.6386C13.4999 33.5062 14.3998 38.0372 14.6573 39.1064C14.8574 39.9372 15.0232 40.67 15.19 41.4072L15.3424 42.079C15.553 43.0076 15.8658 45.4708 15.905 45.7829C15.9069 45.7953 15.9078 45.8045 15.9084 45.8106C15.9087 45.8134 15.9092 45.8172 15.9092 45.8172L15.194 45.9011C15.194 45.9011 15.1926 45.8948 15.1919 45.885C15.1702 45.7297 14.8903 43.9166 13.2704 42.3687C12.1976 41.3428 11.7603 40.93 11.5832 40.7634L11.5797 40.7641L11.4489 40.6403L11.4468 40.6383C11.3388 40.535 9.42088 38.7 8.93531 37.4773L8.80935 37.1618L8.80106 37.1409C8.44396 36.2427 8.34609 35.9965 8.25303 35.5215C8.25112 35.5106 8.24905 35.4998 8.24697 35.4888C8.24451 35.4758 8.24202 35.4627 8.23974 35.4494C7.85697 36.3864 7.39232 38.0001 7.4623 40.2099C7.58686 44.1818 8.97519 47.456 9.03467 47.5932C9.08996 47.7226 9.2488 48.1236 9.45523 48.6463L9.46837 48.6795C9.954 49.9062 10.6769 51.7321 10.9688 52.332L11.7358 53.9085L10.409 52.7623C3.79413 47.0445 0 38.7593 0 30.0297ZM27.8157 59.2541C28.5644 59.3107 29.2971 59.3387 29.9997 59.3387C46.1446 59.3387 59.2799 46.1908 59.2799 30.0297C59.2799 13.8687 46.1446 0.720058 29.9997 0.720058C13.8554 0.720058 0.720058 13.8687 0.720058 30.0297C0.720058 37.9973 3.95927 45.5862 9.65956 51.1011C9.36496 50.3761 9.04097 49.5574 8.78556 48.9115C8.58262 48.3986 8.42658 48.0046 8.37199 47.8773C8.21875 47.5204 6.8689 44.27 6.74154 40.2323C6.61838 36.3171 8.0564 34.1842 8.11798 34.0954L8.63861 33.3396L8.77086 34.2479C8.77156 34.2549 8.86673 34.9036 8.9605 35.3829C9.04167 35.7958 9.12564 36.0071 9.47902 36.8951L9.60498 37.2114C10.0353 38.2961 11.9261 40.0994 11.9457 40.1176L11.931 40.133C12.1651 40.3154 12.6366 40.7658 13.7642 41.8432L13.7686 41.8474C14.1842 42.2449 14.5201 42.6563 14.7916 43.0566C14.7378 42.7305 14.686 42.4429 14.6398 42.2385L14.4814 41.5391C14.3173 40.8145 14.1538 40.0922 13.9568 39.275C13.6965 38.1953 12.7882 33.6251 12.2844 29.7302C11.2942 22.0258 14.9834 17.8664 15.1408 17.6929L15.8924 16.8664L15.7657 17.9763C15.7643 17.9882 15.6272 19.21 15.6999 20.5318C15.7601 21.6395 16.3647 23.5212 17.3171 25.5645C17.8993 26.8136 19.5549 29.416 21.4723 32.4292C22.1175 33.4425 22.7935 34.5054 23.4729 35.5852L24.1118 36.5998C26.4225 40.2666 27.9493 42.6899 28.8933 45.2007C29.7596 47.5071 30.0724 50.0402 29.8492 52.9457C29.7533 55.3011 28.4371 58.098 27.8157 59.2541Z"
                fill="#004B83"
              />
            </svg>
          </v-list-item-avatar>

          <v-list-item-content>
            <v-list-item-title>
              <span class="primary--text font-weight-bold body-1">
                IAP
              </span>
            </v-list-item-title>
            <v-list-item-subtitle class="mt-n2">
              <span class="primary--text body-2">
                Paulo Afonso
              </span>
            </v-list-item-subtitle>
          </v-list-item-content>
        </v-list-item>

        <v-divider></v-divider>

        <v-list-item-group active-class="primary lighten-2 white--text">
          <router-link
            v-for="(route, index) in routes"
            :key="index"
            :to="{ name: route.path_name }"
            v-slot="{ href }"
          >
            <v-list-item :to="href">
              <v-list-item-title>
                {{ route.title }}
              </v-list-item-title>
            </v-list-item>
          </router-link>
        </v-list-item-group>
      </v-list>

      <template v-slot:append>
        <div
          class="primary lighten-2 py-4 px-2 text-center white--text"
          cols="12"
        >
          <p class="mb-0">
            Igreja Adventista da Promessa
          </p>
          <p class="mb-0 font-weight-bold">
            Paulo Afonso
          </p>
        </div>
      </template>
    </v-navigation-drawer>
  </div>
</template>

<script>
import { mapActions } from "vuex";
import Authentication from "./layouts/Authentication";

export default {
  components: { Authentication },
  data() {
    return {
      drawer: false,
      routes: [
        {
          path_name: "home",
          title: "Início",
        },
        {
          path_name: "news",
          title: "Notícias",
        },
        {
          path_name: "verses_of_day",
          title: "Versículos do dia",
        },
        {
          path_name: "messages",
          title: "Mensagens",
        },
        {
          path_name: "schedules",
          title: "Agenda",
        },
        {
          path_name: "contact",
          title: "Contato",
        },
      ],
      profileMenu: false,
    };
  },
  created() {
    this.loadUser();
  },
  computed: {
    userSigned() {
      return (
        !!this.$store.state.user.user &&
        Object.keys(this.$store.state.user.user).length > 0
      );
    },
  },
  methods: {
    ...mapActions(["loadUser"]),
    signOut() {
      this.$cookies.remove("jwt");
      this.$store.dispatch("setUser", {});
      // location.reload();
    },
  },
};
</script>

<style lang="scss" scoped>
main .navigation {
  background: linear-gradient(to bottom, #1cb1bb 0%, #1d4e70 100%);
  .v-list-item:not(.v-list-item--active),
  .v-list-item:not(.v-list-item--active) i {
    color: rgba(255, 255, 255, 0.55) !important;
  }
  .v-list-item:not(.v-list-item--active):hover,
  .v-list-item:not(.v-list-item--active):hover i {
    color: #fff !important;
  }
}
</style>
